---
title: GitHub 101
author: "Romain Forestier"
---



Why using github?
Back up
Track changes
Collaboration


Requirements before meeting:
Have git installed (http://git-scm.com/downloads)
Have usethis and gitcreds R package installed install.packages(c(“usethis”,"gitcreds"))



```{bash}
which git
```


Gives the path to git

On windows might need to give the path in global options

Edit git info using R (and usethis package)

```{r}
usethis::edit_git_config()
```



### Initialize a git repo

build a new simple project
no git panel for now

can initialise with git during creation of new project
this command does it to

```{r}
usethis::use_git()
```

Now we have a git tab

Clock button is the history of the project (all the commits done)

## Commiting things

Creating new file
```{r}
file.edit("test.R")
```

Yellow symbols means git is waiting for you to commit or not. Click on it and it becomes green, to add the file for the first time to git. Write commit message and commit.


Now add something in test.R and save. The script is in the git tab in blue, meaning there are differences between git and your local save.
Commit the changes and check the history

Rstudio has a build in tool to show you the changes between each commit.

That's the track change function of Git

## Connecting GitHub and goind online

Create a github account

Now, github uses personal access tokens (PAT) instead of passwords. Once can also use SSH to connect with GitHub but if you know what SSH is, you also know how to set it up yourself probably.

```{r}
usethis::create_github_token()
```

This sends you in your git hub account where you can create a PAT that will allow you to send your local code in your repositories in GitHub. Think of the PAT as a strong password with editable privileges.

Once you create your PAT store it somewhere as you are never going to see it again on GitHub


Now to connect to github the easiest is to store your credentials with Rstudio

```{r}
gitcreds::gitcreds_set()
```

You need to enter your PAT in the password slot. The passworkd you use to connect to your github account won't work.

Now you will be able to host your R projects into GitHub repositories


Different cases

Rstudio first

For when you already have a project that you want to put on GitHub

You need to have git set up in your project with `use_git()` first, then use

```{r}
usethis::use_github()

```

Easy done


GitHub first

When you create a new project in Rstudio, you can select the version control option and you need to enter the GitHUb url to link (green code button) it to your project


Now that everything is connected we can start collaborating! 

Git has it own language full of strange terms and we are going to unveil them now

First thing to know, even if you do not wish to collaborate, you will still have to use Git to talk between your local project and the one on GitHub so this applies to you too!

## Push

It means you send (push) your changes towards something else. The basic case is that you have changed some stuff locally and you push it online in your own repo.
You need to commit your changes first. Files that you never commited to git can stay as they are.


## Pull

It means that you grab some code to put it where you initiate the pull. In our case we are getting the code from GitHub into our local Rstudio. You cannot push towards a repo if you have not pulled any changes with your code first.


And that's it, the basics of Git and GitHub.
In the following section we are going to see more advanced stuff usually coming from collaborating with other people


Git is best used with the console so we are going to use mainly the console from now on

## Branch and why do it?

When you initialise a git repo, one branch called "master" is created. If you clone your repo onli with github, the online branch is also going to be called "master". That's the default. 

For example your code works perfectly but you want to add/try something new. One way could be to stay on the same branch and keep commiting. If nothing works you can restore a previous stage of your code but then you will lose all your recent work. A new branch is going to be a bifurcation in your code which allows you to work in parallel with different version of your code. You can create a "dev" branch, try some stuff until it works, and when you are happy about the changes you can merge your "dev" branch into "master" to get only one master branch with all your changes.

You can also have different projects using the same base code (a model for example) and have different branchs depending on how you are using the code. One branch can be a model with an additional component such as pressure/depth/temperature, or even 3 branches, one for each component.


View all the branchs in the repo

```{bash}

git branch

```

Create a new branch. When creating a new branch, you are creating a copy of the branch you are on.


```{bash}
git branch dev

```

But we are still working on the "master" branch at the moment, let's move to the new branch

```{bash}

git checkout dev

```

console says: "switch to branch 'dev'


I don't like this branch anymore. Need to leave the branch first

```{bash}

git checkout master
git branch -d dev

```


Exercise: edit something in a new branch then come back to master -> the changes are not there!
Note: Rstudio buttons have a hard time following what we are doing, it is better to use the console anyway

short cut 

```{bash}
git checkout -b test
```


Now to merge our changes
To do so, we need to be in the branch receiving the changes. Git works like this, it is the same when collaborating. We never push changes towards someone, instead we ask them to pull our changes into their repository

```{bash}

git merge test

```

Console shows what are the difference between the 2 branches

We are done with the test branch now


Check branch status

shows the branch and their Upstream
```{bash}
git branch -vv
```





## manipulating commits


Check the status of your changes

```{bash}
git status

```



Removing the last commit (https://gist.github.com/CrookedNumber/8964442)

To remove the last commit from git, you can simply run git reset --hard HEAD^ If you are removing multiple commits from the top, you can run git reset --hard HEAD~2 to remove the last two commits. You can increase the number to remove even more commits.

If you want to "uncommit" the commits, but keep the changes around for reworking, remove the "--hard": git reset HEAD^ which will evict the commits from the branch and from the index, but leave the working tree around.

If you want to save the commits on a new branch name, then run git branch newbranchname before doing the git reset.


restoring commits: http://gitready.com/advanced/2009/01/17/restoring-lost-commits.html

## aliases

change origin / upstream

shows remote and local branches with tracking info.

```{bash}
git remote show origin
```

If no upstream is selected for your local branch

```{bash}
git push --set-upstream origin branch_name
```

Change Git Remote URL
In order to change the URL of a Git remote, you have to use the “git remote set-url” command and specify the name of the remote as well as the new remote URL to be changed.
$ git remote set-url <remote_name> <remote_url>
For example, let’s say that you want to change the URL of your Git origin remote.
In order to achieve that, you would use the “set-url” command on the “origin” remote and you would specify the new URL.
$ git remote set-url origin https://git-repo/new-repository.git
git remote set-url origin https://baldrech:PAT@github.com/jporobicg/ECOSUM


## Fork and why do it?

why

authority on branch


## pull request? what is it?








Stackoverflow is your friend

Useful link: http://r-bio.github.io/git-installation/
https://docs.github.com/en/get-started/quickstart/set-up-git
